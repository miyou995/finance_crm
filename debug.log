2025-09-17 13:58:50,374 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/urls.py changed, reloading.
2025-09-17 13:58:51,184 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 13:58:57,349 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/views.py changed, reloading.
2025-09-17 13:58:58,132 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 13:59:12,493 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/views.py changed, reloading.
2025-09-17 13:59:13,323 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 13:59:26,687 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/models/company.py changed, reloading.
2025-09-17 13:59:27,454 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 13:59:29,907 apps.core.mixins ERROR    Monthly data aggregation error: Unsupported lookup 'invoicess' for BigAutoField or join on the field not permitted.
2025-09-17 13:59:29,909 apps.core.mixins ERROR    Chart rendering error: Unsupported lookup 'invoicess' for BigAutoField or join on the field not permitted.
2025-09-17 13:59:29,991 django.request ERROR    Internal Server Error: /companies/detail/charts/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 890, in get
    labels, chart_data = self.get_monthly_data(queryset)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 822, in get_monthly_data
    .annotate(total=self.aggregate_function(self.field_to_aggregate))
     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/aggregates.py", line 63, in resolve_expression
    c = super().resolve_expression(query, allow_joins, reuse, summarize)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'invoicess' for BigAutoField or join on the field not permitted.
2025-09-17 13:59:37,072 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/views.py changed, reloading.
2025-09-17 13:59:37,898 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:00:32,864 django.request WARNING  Not Found: /.well-known/appspecific/com.chrome.devtools.json
2025-09-17 14:00:50,232 django.request WARNING  Not Found: /.well-known/appspecific/com.chrome.devtools.json
2025-09-17 14:00:57,174 django.request WARNING  Not Found: /.well-known/appspecific/com.chrome.devtools.json
2025-09-17 14:03:13,870 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 14:03:14,728 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:14:25,621 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:14:26,499 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:14:28,627 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:14:29,442 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:14:35,615 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:14:36,457 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:14:47,776 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:14:48,644 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:14:53,526 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 14:14:54,335 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:15:00,267 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 14:15:01,078 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:17:03,886 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 14:17:04,651 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:17:06,476 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:17:07,253 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:17:18,281 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:17:19,053 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:17:23,928 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:17:24,732 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:19:53,735 django.request ERROR    Internal Server Error: /companies/detail/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 159, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 327, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 480, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/base.py", line 98, in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/resolvers.py", line 831, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'create_company_clientpayment' not found. 'create_company_clientpayment' is not a valid view function or pattern name.
2025-09-17 14:35:05,687 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:35:06,512 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:35:12,680 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 14:35:13,467 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:35:14,504 django.request ERROR    Internal Server Error: /companies/detail/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 159, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 210, in render
    return template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 173, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 327, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 327, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 480, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/base.py", line 98, in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/resolvers.py", line 831, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'list_clientpayment' not found. 'list_clientpayment' is not a valid view function or pattern name.
2025-09-17 14:35:14,750 django.request WARNING  Not Found: /favicon.ico
2025-09-17 14:35:24,609 django.request ERROR    Internal Server Error: /companies/detail/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 159, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 210, in render
    return template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 173, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 327, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 327, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 480, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/base.py", line 98, in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/resolvers.py", line 831, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'list_clientpayment' not found. 'list_clientpayment' is not a valid view function or pattern name.
2025-09-17 14:35:24,729 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 14:35:25,517 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:36:00,600 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:36:01,384 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:36:03,416 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:36:04,303 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:36:21,088 django.request ERROR    Internal Server Error: /paiements/invoices/company/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 150, in post
    if form.is_valid():
       ^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/forms.py", line 206, in is_valid
    return self.is_bound and not self.errors
                                 ^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/forms.py", line 201, in errors
    self.full_clean()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/forms.py", line 337, in full_clean
    self._clean_fields()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/forms.py", line 347, in _clean_fields
    value = getattr(self, "clean_%s" % name)()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 66, in clean_amount
    if amount > invoice.rest_amount:
                ^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rest_amount'
2025-09-17 14:36:47,657 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:36:48,456 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:36:53,331 django.request ERROR    Internal Server Error: /paiements/invoices/company/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/psycopg/cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.NotNullViolation: null value in column "client_id" of relation "transactions_clientpayment" violates not-null constraint
DETAIL:  Failing row contains (12, 2025-09-17 13:36:53.287902+00, 2025-09-17 13:36:53.287912+00, cash, 3000.00, 2025-09-17, null, , null, 1, null, null, null).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 176, in form_valid
    instance = form.save(commit=True)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 81, in save
    obj.save()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 902, in save
    self.save_base(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1008, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1169, in _save_table
    results = self._do_insert(
              ^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1210, in _do_insert
    return manager._insert(
           ^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1868, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py", line 1882, in execute_sql
    cursor.execute(sql, params)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/debug_toolbar/panels/sql/tracking.py", line 234, in execute
    return self._record(super().execute, sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/debug_toolbar/panels/sql/tracking.py", line 160, in _record
    return method(sql, params)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/psycopg/cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: null value in column "client_id" of relation "transactions_clientpayment" violates not-null constraint
DETAIL:  Failing row contains (12, 2025-09-17 13:36:53.287902+00, 2025-09-17 13:36:53.287912+00, cash, 3000.00, 2025-09-17, null, , null, 1, null, null, null).
2025-09-17 14:37:07,281 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:37:08,065 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:37:17,348 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:37:18,117 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:38:03,574 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:38:04,328 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:45:43,353 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:45:44,124 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:45:53,285 django.request ERROR    Internal Server Error: /paiements/invoices/company/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 172, in form_valid
    instance = form.save(commit=False)
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 78, in save
    obj.client = self.company_pk
                 ^^^^^^^^^^^^^^^
AttributeError: 'InvoicePaiementModelForm' object has no attribute 'company_pk'
2025-09-17 14:46:16,270 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:46:17,110 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:49:00,375 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:49:01,209 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:49:11,478 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:49:12,255 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:49:14,377 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:49:15,181 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:49:21,594 django.request ERROR    Internal Server Error: /paiements/invoices/company/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 172, in form_valid
    instance = form.save(commit=False)
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 78, in save
    obj.client = self.company_pk
    ^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/fields/related_descriptors.py", line 291, in __set__
    raise ValueError(
ValueError: Cannot assign "3": "ClientPayment.client" must be a "Company" instance.
2025-09-17 14:49:31,958 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:49:32,743 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:49:35,500 django.request ERROR    Internal Server Error: /paiements/invoices/company/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 172, in form_valid
    instance = form.save(commit=False)
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 78, in save
    obj.client.pk = self.company_pk
    ^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/fields/related_descriptors.py", line 271, in __get__
    raise self.RelatedObjectDoesNotExist(
apps.transactions.models.ClientPayment.client.RelatedObjectDoesNotExist: ClientPayment has no client.
2025-09-17 14:50:31,487 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:50:32,291 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:50:38,165 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:50:38,920 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:50:42,999 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:50:43,772 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:50:45,791 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:50:46,558 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:50:48,802 django.request ERROR    Internal Server Error: /paiements/invoices/company/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 30, in create_ledger_entry_signal
    f"{instance.invoice.lead.company} {instance.invoice.bill_number}"
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'lead'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 176, in form_valid
    instance = form.save(commit=True)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 82, in save
    obj.save()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 902, in save
    self.save_base(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1023, in save_base
    post_save.send(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/dispatch/dispatcher.py", line 189, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 50, in create_ledger_entry_signal
    instance.delete()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1281, in delete
    return collector.delete()
           ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/deletion.py", line 507, in delete
    signals.post_delete.send(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/dispatch/dispatcher.py", line 189, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 70, in change_invoice_state_unpaid
    if instance.invoice.rest_amount > 0:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rest_amount'
2025-09-17 14:51:11,517 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/signals.py changed, reloading.
2025-09-17 14:51:12,385 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:51:14,657 django.request ERROR    Internal Server Error: /paiements/invoices/company/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 30, in create_ledger_entry_signal
    f"{instance.invoice.lead.company} {instance.invoice.bill_number}"
       ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'lead'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 176, in form_valid
    instance = form.save(commit=True)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 82, in save
    obj.save()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 902, in save
    self.save_base(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1023, in save_base
    post_save.send(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/dispatch/dispatcher.py", line 189, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 50, in create_ledger_entry_signal
    instance.delete()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1281, in delete
    return collector.delete()
           ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/deletion.py", line 507, in delete
    signals.post_delete.send(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/dispatch/dispatcher.py", line 189, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 73, in change_invoice_state_unpaid
    instance.invoice.save()
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'save'
2025-09-17 14:51:23,043 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/signals.py changed, reloading.
2025-09-17 14:51:23,862 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:51:25,398 root         ERROR    Error creating ledger entry: 'NoneType' object has no attribute 'lead'
2025-09-17 14:52:03,248 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 14:52:04,064 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:52:14,310 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 14:52:15,096 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 14:59:05,203 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 14:59:06,049 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 15:01:47,203 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 15:01:47,991 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:11:04,739 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:11:05,619 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:11:21,097 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:11:21,710 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:11:40,994 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:11:41,425 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:11:44,609 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:11:45,020 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:11:48,201 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:11:48,627 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:11:51,815 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:11:52,240 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:12:00,456 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:12:00,859 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:12:03,042 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:12:03,452 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:13:30,157 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:13:30,588 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:13:41,822 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:13:42,222 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:13:50,441 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:13:50,855 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:14:02,088 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:14:02,505 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:14:11,727 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:14:12,136 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 16:14:43,493 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 16:14:43,897 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 17:40:28,661 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 17:58:48,619 django.request ERROR    Internal Server Error: /quotes/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 159, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/templatetags/django_tables2.py", line 166, in render
    return template.render(context={"table": table}, request=request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 159, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1075, in render
    output = self.filter_expression.resolve(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 722, in resolve
    obj = self.var.resolve(context)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 854, in resolve
    value = self._resolve_lookup(context)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 925, in _resolve_lookup
    current = current()
              ^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 81, in super
    return mark_safe(self.render(self.context))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 243, in render
    nodelist.append(node.render_annotated(context))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 198, in render
    values = list(values)
             ^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/rows.py", line 244, in items
    column.current_value = self.get_cell(column.name)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/rows.py", line 197, in get_cell
    return self._get_and_render_with(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/rows.py", line 155, in _get_and_render_with
    value = display_fn()
            ^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/models.py", line 140, in get_state_display
    states = self.get_allowed_states()
             ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Quote' object has no attribute 'get_allowed_states'
2025-09-17 18:00:11,577 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:00:12,450 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:02:22,023 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:02:22,873 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:02:37,269 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:02:38,110 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:02:39,780 django.request ERROR    Internal Server Error: /quotes/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/utils.py", line 376, in resolve
    current = current[bit]
              ~~~~~~~^^^^^
TypeError: 'Quote' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/utils.py", line 379, in resolve
    current = getattr(current, bit)
              ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Quote' object has no attribute 'get_state_color'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/utils.py", line 382, in resolve
    current = current[int(bit)]
                      ^^^^^^^^
ValueError: invalid literal for int() with base 10: 'get_state_color'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 159, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/templatetags/django_tables2.py", line 166, in render
    return template.render(context={"table": table}, request=request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 159, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1075, in render
    output = self.filter_expression.resolve(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 722, in resolve
    obj = self.var.resolve(context)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 854, in resolve
    value = self._resolve_lookup(context)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 925, in _resolve_lookup
    current = current()
              ^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 81, in super
    return mark_safe(self.render(self.context))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 243, in render
    nodelist.append(node.render_annotated(context))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 198, in render
    values = list(values)
             ^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/rows.py", line 244, in items
    column.current_value = self.get_cell(column.name)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/rows.py", line 197, in get_cell
    return self._get_and_render_with(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/rows.py", line 173, in _get_and_render_with
    return render_func(bound_column, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/rows.py", line 206, in _call_render
    content = call_with_appropriate(bound_column.render, render_kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/utils.py", line 577, in call_with_appropriate
    return fn(**kwargs)
           ^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/columns.py", line 192, in render
    color = self.color_accessor.resolve(record) or "secondary"
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_tables2/utils.py", line 393, in resolve
    raise ValueError(
ValueError: Failed lookup for key [get_state_color] in <class 'apps.billing.models.Quote'>, when resolving the accessor get_state_color
2025-09-17 18:02:46,371 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:02:47,215 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:03:00,592 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:03:01,432 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:03:10,723 django.request ERROR    Internal Server Error: /quotes/1/delete/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 227, in post
    self.get_object().delete()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1281, in delete
    return collector.delete()
           ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/deletion.py", line 507, in delete
    signals.post_delete.send(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/dispatch/dispatcher.py", line 189, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 70, in change_invoice_state_unpaid
    if instance.bill and instance.bill.rest_amount > 0:
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Bill' object has no attribute 'rest_amount'
2025-09-17 18:03:59,321 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:04:00,216 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:07:12,842 django.request ERROR    Internal Server Error: /quotes/1/delete/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 227, in post
    self.get_object().delete()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1281, in delete
    return collector.delete()
           ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/deletion.py", line 507, in delete
    signals.post_delete.send(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/dispatch/dispatcher.py", line 189, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 70, in change_invoice_state_unpaid
    if instance.bill and instance.bill.rest_amount > 0:
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/models.py", line 204, in rest_amount
    return self.get_total_ttc - self.paid_amount
           ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/models.py", line 208, in get_total_ttc
    total_amount = sum(item.get_total_item for item in self.lines.all())
                                                       ^^^^^^^^^^
AttributeError: 'Bill' object has no attribute 'lines'
2025-09-17 18:08:09,453 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/signals.py changed, reloading.
2025-09-17 18:08:10,286 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:08:35,555 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:08:40,085 django.request ERROR    Internal Server Error: /quotes/1/update/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 256, in get_formsets
    "quote_items": QuoteItemModelFormSet(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1107, in __init__
    qs = queryset.filter(**{self.fk.name: self.instance})
         ^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'filter'
2025-09-17 18:08:48,688 django.request ERROR    Internal Server Error: /quotes/1/delete/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 227, in post
    self.get_object().delete()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1281, in delete
    return collector.delete()
           ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/deletion.py", line 507, in delete
    signals.post_delete.send(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/dispatch/dispatcher.py", line 189, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/signals.py", line 70, in change_invoice_state_unpaid
    if instance.bill and instance.bill.rest_amount > 0:
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/models.py", line 204, in rest_amount
    return self.get_total_ttc - self.paid_amount
           ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/models.py", line 208, in get_total_ttc
    total_amount = sum(item.get_total_item for item in self.lines.all())
                                                       ^^^^^^^^^^
AttributeError: 'Bill' object has no attribute 'lines'
2025-09-17 18:09:02,514 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/signals.py changed, reloading.
2025-09-17 18:09:03,326 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:09:17,714 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/signals.py changed, reloading.
2025-09-17 18:09:18,548 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:09:36,086 django.request ERROR    Internal Server Error: /quotes/create/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 256, in get_formsets
    "quote_items": QuoteItemModelFormSet(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:10:59,230 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:11:04,230 django.request ERROR    Internal Server Error: /quotes/create/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 256, in get_formsets
    "quote_items": QuoteItemModelFormSet(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:11:30,462 django.request ERROR    Internal Server Error: /companies/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/views.py", line 290, in get_queryset
    .include_revenue()
     ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/models/company.py", line 41, in include_revenue
    return self.annotate(
           ^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/aggregates.py", line 63, in resolve_expression
    c = super().resolve_expression(query, allow_joins, reuse, summarize)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:13:50,356 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/models/company.py changed, reloading.
2025-09-17 18:13:50,990 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:13:52,163 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/models/company.py changed, reloading.
2025-09-17 18:13:52,785 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:13:56,950 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/models/company.py changed, reloading.
2025-09-17 18:13:57,799 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:13:58,867 django.request ERROR    Internal Server Error: /companies/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/views.py", line 290, in get_queryset
    .include_revenue()
     ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/models/company.py", line 62, in include_revenue
    return self.annotate(
           ^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1659, in _annotate
    self._validate_values_are_expressions(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 2014, in _validate_values_are_expressions
    raise TypeError(
TypeError: QuerySet.annotate() received non-expression(s): 2, 3, 4.
2025-09-17 18:15:10,886 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/models/company.py changed, reloading.
2025-09-17 18:15:11,713 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:15:26,135 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/models/company.py changed, reloading.
2025-09-17 18:15:26,964 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:15:29,810 django.request ERROR    Internal Server Error: /companies/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/views.py", line 290, in get_queryset
    .include_revenue()
     ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/models/company.py", line 41, in include_revenue
    return self.annotate(
           ^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/aggregates.py", line 63, in resolve_expression
    c = super().resolve_expression(query, allow_joins, reuse, summarize)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:15:31,464 django.request ERROR    Internal Server Error: /companies/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/views.py", line 290, in get_queryset
    .include_revenue()
     ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/models/company.py", line 41, in include_revenue
    return self.annotate(
           ^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/aggregates.py", line 63, in resolve_expression
    c = super().resolve_expression(query, allow_joins, reuse, summarize)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:15:39,483 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/models/company.py changed, reloading.
2025-09-17 18:15:40,336 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:15:41,464 django.request ERROR    Internal Server Error: /companies/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/views.py", line 291, in get_queryset
    .select_related(
     ^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'select_related'
2025-09-17 18:15:51,856 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/models/company.py changed, reloading.
2025-09-17 18:15:52,717 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:15:53,832 django.request ERROR    Internal Server Error: /companies/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/views.py", line 290, in get_queryset
    .include_revenue()
     ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/models/company.py", line 41, in include_revenue
    return self.annotate(
           ^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/aggregates.py", line 63, in resolve_expression
    c = super().resolve_expression(query, allow_joins, reuse, summarize)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:16:23,594 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/views.py changed, reloading.
2025-09-17 18:16:24,448 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:16:32,495 django.request ERROR    Internal Server Error: /companies/detail/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/detail.py", line 113, in get
    context = self.get_context_data(object=self.object)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/crm/views.py", line 468, in get_context_data
    context["payments_count"] = ClientPayment.objects.filter(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1493, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1511, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1518, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1646, in add_q
    clause, _ = self._add_q(q_object, can_reuse)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1526, in build_filter
    lookups, parts, reffed_expression = self.solve_lookup_type(arg, summarize)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1333, in solve_lookup_type
    _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1805, in names_to_path
    raise FieldError(
django.core.exceptions.FieldError: Cannot resolve keyword 'invoice' into field. Choices are: amount, bill, bill_id, client, client_id, created_at, created_by, created_by_id, date, id, journal, journal_id, ledger_entries, notes, payment_method, reference, updated_at, updated_by, updated_by_id
2025-09-17 18:16:40,189 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/views.py changed, reloading.
2025-09-17 18:16:41,020 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:16:53,389 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/crm/views.py changed, reloading.
2025-09-17 18:16:54,213 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:16:56,244 apps.core.mixins ERROR    Monthly data aggregation error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:16:56,245 apps.core.mixins ERROR    Chart rendering error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:16:56,360 django.request ERROR    Internal Server Error: /companies/detail/charts/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 890, in get
    labels, chart_data = self.get_monthly_data(queryset)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 820, in get_monthly_data
    queryset.annotate(month=TruncMonth(self.date_field))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/functions/datetime.py", line 287, in resolve_expression
    copy = super().resolve_expression(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:16:56,362 django.request ERROR    Internal Server Error: /invoices-paiements/company_invoices_payment/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/views.py", line 104, in get_queryset
    queryset = ClientPayment.objects.filter(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1493, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1511, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1518, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1646, in add_q
    clause, _ = self._add_q(q_object, can_reuse)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1503, in build_filter
    return self._add_q(
           ^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1526, in build_filter
    lookups, parts, reffed_expression = self.solve_lookup_type(arg, summarize)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1333, in solve_lookup_type
    _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1805, in names_to_path
    raise FieldError(
django.core.exceptions.FieldError: Cannot resolve keyword 'invoice' into field. Choices are: amount, bill, bill_id, client, client_id, created_at, created_by, created_by_id, date, id, journal, journal_id, ledger_entries, notes, payment_method, reference, updated_at, updated_by, updated_by_id
2025-09-17 18:17:06,344 django.request ERROR    Internal Server Error: /quotes/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 256, in get_formsets
    "quote_items": QuoteItemModelFormSet(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:17:20,414 apps.core.mixins ERROR    Monthly data aggregation error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:17:20,419 apps.core.mixins ERROR    Chart rendering error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:17:20,546 django.request ERROR    Internal Server Error: /invoices-paiements/company_invoices_payment/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/views.py", line 104, in get_queryset
    queryset = ClientPayment.objects.filter(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1493, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1511, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1518, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1646, in add_q
    clause, _ = self._add_q(q_object, can_reuse)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1503, in build_filter
    return self._add_q(
           ^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1526, in build_filter
    lookups, parts, reffed_expression = self.solve_lookup_type(arg, summarize)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1333, in solve_lookup_type
    _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1805, in names_to_path
    raise FieldError(
django.core.exceptions.FieldError: Cannot resolve keyword 'invoice' into field. Choices are: amount, bill, bill_id, client, client_id, created_at, created_by, created_by_id, date, id, journal, journal_id, ledger_entries, notes, payment_method, reference, updated_at, updated_by, updated_by_id
2025-09-17 18:17:20,604 django.request ERROR    Internal Server Error: /companies/detail/charts/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 890, in get
    labels, chart_data = self.get_monthly_data(queryset)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 820, in get_monthly_data
    queryset.annotate(month=TruncMonth(self.date_field))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/functions/datetime.py", line 287, in resolve_expression
    copy = super().resolve_expression(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:17:25,384 apps.core.mixins ERROR    Monthly data aggregation error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:17:25,389 apps.core.mixins ERROR    Chart rendering error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:17:25,504 django.request ERROR    Internal Server Error: /invoices-paiements/company_invoices_payment/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/views.py", line 104, in get_queryset
    queryset = ClientPayment.objects.filter(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1493, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1511, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1518, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1646, in add_q
    clause, _ = self._add_q(q_object, can_reuse)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1503, in build_filter
    return self._add_q(
           ^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1526, in build_filter
    lookups, parts, reffed_expression = self.solve_lookup_type(arg, summarize)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1333, in solve_lookup_type
    _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1805, in names_to_path
    raise FieldError(
django.core.exceptions.FieldError: Cannot resolve keyword 'invoice' into field. Choices are: amount, bill, bill_id, client, client_id, created_at, created_by, created_by_id, date, id, journal, journal_id, ledger_entries, notes, payment_method, reference, updated_at, updated_by, updated_by_id
2025-09-17 18:17:25,607 django.request ERROR    Internal Server Error: /companies/detail/charts/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 890, in get
    labels, chart_data = self.get_monthly_data(queryset)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 820, in get_monthly_data
    queryset.annotate(month=TruncMonth(self.date_field))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/functions/datetime.py", line 287, in resolve_expression
    copy = super().resolve_expression(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:18:52,282 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 18:18:53,174 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:19:23,953 apps.core.mixins ERROR    Monthly data aggregation error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:19:23,954 apps.core.mixins ERROR    Chart rendering error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:19:24,053 django.request ERROR    Internal Server Error: /companies/detail/charts/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 890, in get
    labels, chart_data = self.get_monthly_data(queryset)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 820, in get_monthly_data
    queryset.annotate(month=TruncMonth(self.date_field))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/functions/datetime.py", line 287, in resolve_expression
    copy = super().resolve_expression(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:19:24,067 django.request ERROR    Internal Server Error: /invoices-paiements/company_invoices_payment/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/contrib/auth/mixins.py", line 109, in dispatch
    return super().dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 74, in get
    self.filterset = self.get_filterset(filterset_class)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 37, in get_filterset
    kwargs = self.get_filterset_kwargs(filterset_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django_filters/views.py", line 51, in get_filterset_kwargs
    "queryset": self.get_queryset(),
                ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/views.py", line 104, in get_queryset
    queryset = ClientPayment.objects.filter(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1493, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1511, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1518, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1646, in add_q
    clause, _ = self._add_q(q_object, can_reuse)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1503, in build_filter
    return self._add_q(
           ^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1678, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1526, in build_filter
    lookups, parts, reffed_expression = self.solve_lookup_type(arg, summarize)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1333, in solve_lookup_type
    _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1805, in names_to_path
    raise FieldError(
django.core.exceptions.FieldError: Cannot resolve keyword 'invoice' into field. Choices are: amount, bill, bill_id, client, client_id, created_at, created_by, created_by_id, date, id, journal, journal_id, ledger_entries, notes, payment_method, reference, updated_at, updated_by, updated_by_id
2025-09-17 18:19:45,350 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 18:19:46,197 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:20:27,316 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/tables.py changed, reloading.
2025-09-17 18:20:28,143 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:20:36,794 apps.core.mixins ERROR    Monthly data aggregation error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:20:36,796 apps.core.mixins ERROR    Chart rendering error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:20:36,937 django.request ERROR    Internal Server Error: /companies/detail/charts/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 890, in get
    labels, chart_data = self.get_monthly_data(queryset)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 820, in get_monthly_data
    queryset.annotate(month=TruncMonth(self.date_field))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/functions/datetime.py", line 287, in resolve_expression
    copy = super().resolve_expression(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:20:48,418 apps.core.mixins ERROR    Monthly data aggregation error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:20:48,422 apps.core.mixins ERROR    Chart rendering error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:20:48,554 django.request ERROR    Internal Server Error: /companies/detail/charts/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 890, in get
    labels, chart_data = self.get_monthly_data(queryset)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 820, in get_monthly_data
    queryset.annotate(month=TruncMonth(self.date_field))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/functions/datetime.py", line 287, in resolve_expression
    copy = super().resolve_expression(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:20:52,562 apps.core.mixins ERROR    Monthly data aggregation error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:20:52,564 apps.core.mixins ERROR    Chart rendering error: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:20:52,719 django.request ERROR    Internal Server Error: /companies/detail/charts/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 890, in get
    labels, chart_data = self.get_monthly_data(queryset)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 820, in get_monthly_data
    queryset.annotate(month=TruncMonth(self.date_field))
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1649, in annotate
    return self._annotate(args, kwargs, select=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1701, in _annotate
    clone.query.add_annotation(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1218, in add_annotation
    annotation = annotation.resolve_expression(self, allow_joins=True, reuse=None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/functions/datetime.py", line 287, in resolve_expression
    copy = super().resolve_expression(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 300, in resolve_expression
    expr.resolve_expression(query, allow_joins, reuse, summarize, for_save)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/expressions.py", line 902, in resolve_expression
    return query.resolve_ref(self.name, allow_joins, reuse, summarize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 2065, in resolve_ref
    transform = join_info.transform_function(targets[0], final_alias)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1922, in transform
    wrapped = previous(field, alias)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1923, in transform
    return self.try_transform(wrapped, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1458, in try_transform
    raise FieldError(
django.core.exceptions.FieldError: Unsupported lookup 'payments' for BigAutoField or join on the field not permitted.
2025-09-17 18:21:58,079 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/models.py changed, reloading.
2025-09-17 18:21:58,956 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:22:14,576 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:22:26,115 django.request ERROR    Internal Server Error: /quotes/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 256, in get_formsets
    "quote_items": QuoteItemModelFormSet(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:23:13,815 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 108, in get_formsets
    "invoice_items": InvoiceItemModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:28:27,248 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 108, in get_formsets
    "invoice_items": InvoiceItemModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:30:29,782 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:30:30,671 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:30:44,079 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:30:44,943 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:30:48,607 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 108, in get_formsets
    "invoice_items": InvoiceItemModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:30:50,518 django.request ERROR    Internal Server Error: /quotes/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 256, in get_formsets
    "quote_items": QuoteItemModelFormSet(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:31:20,382 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:31:21,224 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:31:28,631 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:31:29,469 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:31:49,847 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 108, in get_formsets
    "invoice_items": InvoiceItemModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:33:48,717 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:33:49,597 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:34:10,736 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 108, in get_formsets
    "invoice_items": InvoiceItemModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:35:34,093 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:35:34,937 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:35:48,328 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:35:49,200 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:35:59,741 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:36:02,896 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 142, in get_context_data
    context["create_url"] = self.model.get_create_url(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CRUDUrlMixin.get_create_url() got an unexpected keyword argument 'company_pk'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 146, in get_context_data
    context["create_url"] = self.model.get_create_url()
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/models.py", line 20, in get_create_url
    return reverse(f"{cls._meta.app_label}:create_{cls._meta.model_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/base.py", line 98, in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/resolvers.py", line 831, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'create_bill' not found. 'create_bill' is not a valid view function or pattern name.
2025-09-17 18:36:22,785 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:36:23,623 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:37:25,392 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:37:26,245 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:37:29,388 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:37:30,017 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:37:31,196 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:37:31,825 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:37:34,939 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:37:35,816 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:37:44,095 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:37:44,951 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:37:52,169 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:37:53,010 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:37:57,195 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:37:58,039 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:38:02,284 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 109, in get_formsets
    "invoice_items": InvoiceItemModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:38:10,840 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:38:11,686 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:38:13,546 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:38:14,338 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:38:17,692 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 142, in get_context_data
    context["create_url"] = self.model.get_create_url(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CRUDUrlMixin.get_create_url() got an unexpected keyword argument 'company_pk'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 146, in get_context_data
    context["create_url"] = self.model.get_create_url()
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/models.py", line 20, in get_create_url
    return reverse(f"{cls._meta.app_label}:create_{cls._meta.model_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/base.py", line 98, in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/resolvers.py", line 831, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'create_bill' not found. 'create_bill' is not a valid view function or pattern name.
2025-09-17 18:38:50,497 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:38:51,348 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:38:57,550 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:38:58,371 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:04,549 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:05,362 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:14,642 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:15,445 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:17,508 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:18,326 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:22,460 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:23,290 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:26,385 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:27,197 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:29,259 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:30,077 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:34,218 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:35,035 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:44,320 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:45,138 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:39:50,306 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:39:51,120 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:40:20,960 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:40:21,799 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:40:29,033 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:40:29,868 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:40:32,992 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:40:33,837 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:40:38,995 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:40:39,838 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:40:43,412 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 109, in get_formsets
    "invoice_items": InvoiceItemModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:40:50,725 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:40:51,556 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:41:29,619 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:41:30,455 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:41:32,941 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 109, in get_formsets
    "invoice_items": InvoiceItemModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:41:41,949 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:41:42,797 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:43:17,417 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:43:18,230 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:43:37,763 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:43:38,578 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:43:40,657 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:43:41,460 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:43:45,589 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:43:46,407 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:44:04,981 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:44:05,822 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:44:09,844 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 109, in get_formsets
    "invoice_items": BillLineModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:48:52,161 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:48:53,012 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:48:56,448 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 157, in get_context_data
    context["formsets"] = self.get_formsets()
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/views.py", line 109, in get_formsets
    "invoice_items": BillLineModelFormSet(
                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 1109, in __init__
    qs = queryset.none()
         ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'none'
2025-09-17 18:49:13,224 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:49:14,078 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:49:33,641 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:49:34,490 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:49:45,494 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:50:50,414 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:50:51,290 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:50:55,185 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/views.py changed, reloading.
2025-09-17 18:50:55,980 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:51:02,700 django.request ERROR    Internal Server Error: /invoices/create/3/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 142, in get_context_data
    context["create_url"] = self.model.get_create_url(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CRUDUrlMixin.get_create_url() got an unexpected keyword argument 'company_pk'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 146, in get_context_data
    context["create_url"] = self.model.get_create_url()
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/models.py", line 20, in get_create_url
    return reverse(f"{cls._meta.app_label}:create_{cls._meta.model_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/base.py", line 98, in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/resolvers.py", line 831, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'create_invoice' not found. 'create_invoice' is not a valid view function or pattern name.
2025-09-17 18:51:15,119 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/urls.py changed, reloading.
2025-09-17 18:51:15,985 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:51:45,957 django.request ERROR    Internal Server Error: /invoices/create/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 176, in form_valid
    instance = form.save(commit=True)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/forms/models.py", line 554, in save
    self.instance.save()
  File "/home/taki/Desktop/octopus_crm/apps/billing/models.py", line 402, in save
    self.bill_type = self.BillType.INVOICE
                     ^^^^^^^^^^^^^
AttributeError: 'Invoice' object has no attribute 'BillType'. Did you mean: 'bill_type'?
2025-09-17 18:52:04,810 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:52:05,666 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:52:41,680 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:52:42,542 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:01,077 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:01,917 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:04,006 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:04,821 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:07,920 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:08,792 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:19,084 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:19,921 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:30,242 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:31,105 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:33,218 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:34,036 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:40,241 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:41,067 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:44,211 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:45,034 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:53:58,411 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:53:59,237 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:54:01,340 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:54:02,182 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:54:05,301 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:54:06,145 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:54:16,441 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/forms.py changed, reloading.
2025-09-17 18:54:17,298 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:54:30,682 django.request ERROR    Internal Server Error: /invoices/1/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 890, in _resolve_lookup
    raise TypeError
TypeError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 159, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/test/utils.py", line 114, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 65, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1016, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 977, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 1075, in render
    output = self.filter_expression.resolve(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 722, in resolve
    obj = self.var.resolve(context)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 854, in resolve
    value = self._resolve_lookup(context)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/template/base.py", line 901, in _resolve_lookup
    current = getattr(current, bit)
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/billing/models.py", line 198, in rest_amount
    return self.get_total_ttc - self.paid_amount
                                ^^^^^^^^^^^^^^^^
AttributeError: 'Invoice' object has no attribute 'paid_amount'. Did you mean: 'rest_amount'?
2025-09-17 18:54:30,942 django.request WARNING  Not Found: /favicon.ico
2025-09-17 18:55:00,809 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:55:01,687 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:55:05,857 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/billing/models.py changed, reloading.
2025-09-17 18:55:06,692 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:55:11,279 weasyprint   WARNING  Ignored `box-shadow: 0 4px 24px rgba(0,0,0,0.08)` at 1:94, unknown property.
2025-09-17 18:55:11,371 weasyprint   ERROR    Failed to load image at 'http://localhost:8000/media/images/logos/light-logo_vCMRv5J.png': UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x752c47e00040>
2025-09-17 18:55:19,050 django.request WARNING  Not Found: /paiements/invoices/create
2025-09-17 18:55:25,681 django.request WARNING  Not Found: /paiements/invoices/create
2025-09-17 18:57:43,358 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 18:57:44,207 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:58:05,817 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 18:58:06,651 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:58:16,959 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 18:58:17,778 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:58:29,103 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 18:58:29,922 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:58:48,447 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 18:58:49,258 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:59:15,683 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 18:59:16,509 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:59:18,333 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 18:59:19,141 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:59:24,063 django.request ERROR    Internal Server Error: /paiements/invoice/invoicepayment/1/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 128, in get_context_data
    context = super().get_context_data(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 72, in get_context_data
    kwargs["form"] = self.get_form()
                     ^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 37, in get_form
    return form_class(**self.get_form_kwargs())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 45, in __init__
    super().__init__(*args, **kwargs)
TypeError: BaseModelForm.__init__() got an unexpected keyword argument 'invoice_pk'
2025-09-17 18:59:37,931 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 18:59:38,773 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:59:43,970 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/views.py changed, reloading.
2025-09-17 18:59:44,805 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 18:59:48,958 django.request ERROR    Internal Server Error: /paiements/invoice/invoicepayment/1/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 142, in get_context_data
    context["create_url"] = self.model.get_create_url(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/models.py", line 174, in get_create_url
    return reverse(
           ^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/base.py", line 98, in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/resolvers.py", line 831, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'create_bill_clientpayment' not found. 'create_bill_clientpayment' is not a valid view function or pattern name.
2025-09-17 19:01:11,080 django.request ERROR    Internal Server Error: /paiements/invoice/invoicepayment/1/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 142, in get
    return self.render_to_response(self.get_context_data())
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 142, in get_context_data
    context["create_url"] = self.model.get_create_url(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/models.py", line 174, in get_create_url
    return reverse(
           ^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/base.py", line 98, in reverse
    resolved_url = resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/urls/resolvers.py", line 831, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'create_bill_clientpayment' not found. 'create_bill_clientpayment' is not a valid view function or pattern name.
2025-09-17 19:16:55,050 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/urls.py changed, reloading.
2025-09-17 19:16:55,899 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:17:11,593 django.request WARNING  Not Found: /paiements/invoices/invoice/create/1/
2025-09-17 19:18:01,092 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:18:01,940 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:18:06,095 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:18:06,926 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:18:11,317 django.request WARNING  Not Found: /paiements/invoices/invoice/create/1/
2025-09-17 19:18:35,056 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:18:35,894 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:18:37,524 django.request WARNING  Not Found: /paiements/invoices/invoice/create/1/
2025-09-17 19:18:53,404 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:18:54,244 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:18:59,427 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:19:00,246 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:19:15,682 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:19:16,514 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:19:21,700 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:19:22,515 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:20:09,015 django.request WARNING  Not Found: /paiements/invoices/invoice/create/1/
2025-09-17 19:20:54,507 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:20:55,327 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:21:05,636 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:21:06,452 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:21:26,016 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:21:26,852 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:21:32,036 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:21:32,888 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:21:36,009 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:21:36,838 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:21:39,672 django.request ERROR    Internal Server Error: /paiements/invoices/invoice/create/1/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/psycopg/cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.NotNullViolation: null value in column "bill_id" of relation "transactions_clientpayment" violates not-null constraint
DETAIL:  Failing row contains (16, 2025-09-17 18:21:39.642655+00, 2025-09-17 18:21:39.642668+00, cash, 300.00, 2025-09-17, null, , 3, 1, null, null, null).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 176, in form_valid
    instance = form.save(commit=True)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 89, in save
    obj.save()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 902, in save
    self.save_base(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1008, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1169, in _save_table
    results = self._do_insert(
              ^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1210, in _do_insert
    return manager._insert(
           ^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1868, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py", line 1882, in execute_sql
    cursor.execute(sql, params)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/debug_toolbar/panels/sql/tracking.py", line 234, in execute
    return self._record(super().execute, sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/debug_toolbar/panels/sql/tracking.py", line 160, in _record
    return method(sql, params)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/psycopg/cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: null value in column "bill_id" of relation "transactions_clientpayment" violates not-null constraint
DETAIL:  Failing row contains (16, 2025-09-17 18:21:39.642655+00, 2025-09-17 18:21:39.642668+00, cash, 300.00, 2025-09-17, null, , 3, 1, null, null, null).
2025-09-17 19:22:06,910 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:22:07,741 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:22:11,941 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:22:12,781 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:22:14,368 django.request ERROR    Internal Server Error: /paiements/invoices/invoice/create/1/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/psycopg/cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.NotNullViolation: null value in column "bill_id" of relation "transactions_clientpayment" violates not-null constraint
DETAIL:  Failing row contains (17, 2025-09-17 18:22:14.339158+00, 2025-09-17 18:22:14.33917+00, cash, 300.00, 2025-09-17, null, , 3, 1, null, null, null).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 176, in form_valid
    instance = form.save(commit=True)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 89, in save
    obj.save()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 902, in save
    self.save_base(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1008, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1169, in _save_table
    results = self._do_insert(
              ^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1210, in _do_insert
    return manager._insert(
           ^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1868, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py", line 1882, in execute_sql
    cursor.execute(sql, params)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/debug_toolbar/panels/sql/tracking.py", line 234, in execute
    return self._record(super().execute, sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/debug_toolbar/panels/sql/tracking.py", line 160, in _record
    return method(sql, params)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/psycopg/cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: null value in column "bill_id" of relation "transactions_clientpayment" violates not-null constraint
DETAIL:  Failing row contains (17, 2025-09-17 18:22:14.339158+00, 2025-09-17 18:22:14.33917+00, cash, 300.00, 2025-09-17, null, , 3, 1, null, null, null).
2025-09-17 19:22:23,262 django.utils.autoreload INFO     Watching for file changes with StatReloader
2025-09-17 19:22:25,640 django.request ERROR    Internal Server Error: /paiements/invoices/invoice/create/1/
Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/psycopg/cursor.py", line 97, in execute
    raise ex.with_traceback(None)
psycopg.errors.NotNullViolation: null value in column "bill_id" of relation "transactions_clientpayment" violates not-null constraint
DETAIL:  Failing row contains (18, 2025-09-17 18:22:25.610241+00, 2025-09-17 18:22:25.610257+00, cash, 300.00, 2025-09-17, null, , 3, 1, null, null, null).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 105, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/base.py", line 144, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/views/generic/edit.py", line 151, in post
    return self.form_valid(form)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/core/mixins.py", line 176, in form_valid
    instance = form.save(commit=True)
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/apps/transactions/forms.py", line 89, in save
    obj.save()
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 902, in save
    self.save_base(
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1008, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1169, in _save_table
    results = self._do_insert(
              ^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/base.py", line 1210, in _do_insert
    return manager._insert(
           ^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/query.py", line 1868, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py", line 1882, in execute_sql
    cursor.execute(sql, params)
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/debug_toolbar/panels/sql/tracking.py", line 234, in execute
    return self._record(super().execute, sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/debug_toolbar/panels/sql/tracking.py", line 160, in _record
    return method(sql, params)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/django/db/backends/utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/taki/Desktop/octopus_crm/.venv/lib/python3.12/site-packages/psycopg/cursor.py", line 97, in execute
    raise ex.with_traceback(None)
django.db.utils.IntegrityError: null value in column "bill_id" of relation "transactions_clientpayment" violates not-null constraint
DETAIL:  Failing row contains (18, 2025-09-17 18:22:25.610241+00, 2025-09-17 18:22:25.610257+00, cash, 300.00, 2025-09-17, null, , 3, 1, null, null, null).
2025-09-17 19:22:47,059 django.utils.autoreload INFO     /home/taki/Desktop/octopus_crm/apps/transactions/forms.py changed, reloading.
2025-09-17 19:22:47,874 django.utils.autoreload INFO     Watching for file changes with StatReloader
