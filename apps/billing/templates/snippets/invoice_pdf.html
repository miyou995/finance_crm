{% load custom_filters %}
   <div style="max-width: 800px; margin: 0 auto; background: #fff; padding: 32px 40px; border-radius: 12px; box-shadow: 0 4px 24px rgba(0,0,0,0.08);">
            <!-- Header with Logo -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding-bottom: 20px;">
                <div>
                    <img alt="Logo" src="{{ business.logo.url }}" style="max-width: 60px; height: auto;" />
                </div>
            </div>
            
            <!-- Invoice Title -->
            <div style="margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h1 style="font-size: 28px; font-weight: bold; color: #1a1a1a; margin: 0;">Facture {{ invoice.bill_number }}</h1>
                    <div style="font-size: 18px; font-weight: bold; color: #1a1a1a;">{{ invoice.created_at|date:"d M Y" }}</div>
                </div>
                <!-- Date Information -->
                <div style="display: flex; margin-bottom: 30px;">
                    <div style="width: 50%; padding-right: 15px;">
                        
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">RC: <span style="font-weight:bold;">{{ business.rc_code|default:" " }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">Art: <span style="font-weight:bold;">{{ business.art_code|default:" " }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">NIF: <span style="font-weight:bold;">{{ business.nif_code|default:" " }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">NIS: <span style="font-weight:bold;">{{ business.nis_code|default:" " }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">Bank: <span style="font-weight:bold;">{{ business.bank_number|default:" " }}</span></div>
                    </div>
                    <div style="width: 50%; padding-left: 15px;">
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">Destinataire: <span style="font-weight:bold;">{{ invoice.lead.company }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">NIF: <span style="font-weight:bold;">{{ invoice.lead.company.nif|default:" " }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">NRC: <span style="font-weight:bold;">{{ invoice.lead.company.nrc|default:" " }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">NIS: <span style="font-weight:bold;">{{ invoice.lead.company.nis|default:" " }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">NART: <span style="font-weight:bold;">{{ invoice.lead.company.nart|default:" " }}</span></div>
                        <div style="font-size: 14px; font-weight: bold; color: #1a1a1a;">Bank: <span style="font-weight:bold;">{{ invoice.lead.company.bank_name|default:" " }}</span></div>
                    </div>
                </div>
                
                <!-- Billing Information -->
                <div style="display: flex; margin-bottom: 40px;">
                    <div style="width: 50%; padding-right: 15px;">
                        <div style="font-size: 14px; font-weight: 600; color: #666; margin-bottom: 5px;">Émis pour :</div>
                        <div style="font-size: 16px; font-weight: bold; color: #1a1a1a;">{{invoice.lead.company}}</div>
                    </div>
                    <div style="width: 50%; padding-left: 15px;">
                        <div style="font-size: 14px; font-weight: 600; color: #666; margin-bottom: 5px;">Émis par :</div>
                        <div style="font-size: 16px; font-weight: bold; color: #1a1a1a;">{{ business.name_company }}</div>
                        <div style="font-size: 14px; font-weight: 600; color: #666;">{{ business.address }}</div>
                    </div>
                </div>
                
                <!-- Invoice Items Table -->
                <div style="margin-bottom: 30px;">
                    <div style="border-bottom: 1px solid #e5e5e5; margin-bottom: 24px;">
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 0;">
                            <thead>
                                <tr style="border-bottom: 2px solid #e5e5e5; font-size: 15px; color: #888;">
                                    <th style="padding: 12px 8px; text-align: left; font-weight: bold;">{% translate "Description" %}</th>
                                    <th style="padding: 12px 8px; text-align: right; font-weight: bold;">{% translate "Quantité" %}</th>
                                    <th style="padding: 12px 8px; text-align: right; font-weight: bold;">{% translate "Prix" %}</th>
                                    <th style="padding: 12px 8px; text-align: right; font-weight: bold;">{% translate "Remise" %}</th>
                                    <th style="padding: 12px 8px; text-align: right; font-weight: bold;">{% translate "Total" %}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in invoice_items %}
                                <tr style="border-bottom: 1px solid #f0f0f0; font-size: 16px; color: #333;">
                                    <td style="padding: 15px 8px; font-weight: bold;">
                                        <span style="color: #007bff; margin-right: 8px;">•</span>{{ item.title }}
                                    </td>
                                    <td style="padding: 15px 8px; text-align: right;">{{ item.quantity }}</td>
                                    <td style="padding: 15px 8px; text-align: right;">
                                        {{ item.unit_price|floatformat:2 }}{% if item.unit %} / {{ item.unit }}{% endif %}
                                    </td>
                                    <td style="padding: 15px 8px; text-align: right;">{{ item.discount|default:"0" }}</td>
                                    <td style="padding: 15px 8px; text-align: right; font-weight: bold;">
                                        {{ item.get_total_item|floatformat:2 }}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div style="display: flex; justify-content: flex-end;">
                        <div style="min-width: 300px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <div style="color: #666; font-size: 14px; font-weight: 600;">{% translate "Total HT" %}:</div>
                                <div style="font-weight: bold; color: #1a1a1a;">{{ invoice.get_total_net|floatformat:2 }}</div>
                            </div>
                            {% if taxes %}
                                {% for tax in taxes %}
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <div style="color: #666; font-size: 14px; font-weight: 600;">VAT {{ tax.tax }}%</div>
                                        <div style="font-weight: bold; color: #1a1a1a;">
                                            {{ invoice.get_total_net|multiply:tax.tax|divide:100|floatformat:2 }}
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <div style="color: #666; font-size: 14px; font-weight: 600;">{% translate "Total TTC" %}</div>
                                <div style="font-weight: bold; color: #1a1a1a;">{{ invoice.get_total_ttc|floatformat:2 }}</div>
                            </div>
                            {% if invoice.paid_amount and invoice.rest_amount != 0 %}
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <div style="color: #666; font-size: 14px; font-weight: 600;">{% translate "Avance de paiement" %}</div>
                                    <div style="font-weight: bold; color: #1a1a1a;">{{ invoice.paid_amount|floatformat:2 }}</div>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <div style="color: #666; font-size: 14px; font-weight: 600;">{% translate "Montant restant" %}</div>
                                    <div style="font-weight: bold; color: #1a1a1a;">{{ invoice.rest_amount|floatformat:2 }}</div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>    <!-- Total Section -->
                
            </div>
        </div>


